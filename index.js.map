{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = \"51334256-c1710c37c982a8ca30afac428\"; \n\nexport default async function getImagesByQuery(query, page= 1, limit = 15) {\n\n        const { data } = await axios(`https://pixabay.com/api/`, {\n            params:\n            {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                page: page,\n                per_page: limit\n            }\n        });\n    \n    \n        return data;\n    }\n\n   \n\n","import SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"../css/gallery.css\"\n\nexport const loadMoreBtn = document.querySelector(\".load-more-btn\")\nconst gallery = document.querySelector(\".gallery\")\nlet lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionsDelay: 250,\n})\n\nexport function createGallery(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n     <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n             class=\"gallery-image\"\n             src=\"${webformatURL}\"\n             alt=\"${tags}\"\n             width=\"360\"\n            />\n        </a>\n        <div class=\"image-info\">\n            <p><b>Likes</b> ${likes}</p>\n            <p><b>Views</b> ${views}</p>\n            <p><b>Comments</b> ${comments}</p>\n            <p><b>Downloads</b> ${downloads}</p>\n        </div>\n    </li>\n    `).join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n\n    lightbox.refresh();\n}\n\n\nexport function clearGallery() {\n    gallery.innerHTML = '';\n\n    window.scrollTo({\n      top: 0,\n      behavior: 'smooth'\n    });\n}\n\nexport function showLoader() {\n  document.querySelector('.loader').classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n  document.querySelector('.loader').classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add('is-hidden');\n}","import getImagesByQuery from \"./js/pixabay-api\";\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton, loadMoreBtn } from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\nconst form = document.querySelector(\".form\");\nlet page = 1;\nlet limit = 15;\nlet totalPages = 0;\nlet searchQuery = \"\";\n\nform.addEventListener(\"submit\", handleSubmit);\nloadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\nasync function handleSubmit(event) {\n    clearGallery();\n    event.preventDefault();\n    page = 1;\n\n\n    const query = event.currentTarget.elements.searchText;\n    const trimmedQuery = query.value.trim();\n    searchQuery = trimmedQuery;\n\n    if (!trimmedQuery) {\n        iziToast.info({\n            title: \"Please!\",\n            message: \"Enter request!\",\n            position: \"topRight\",\n            timeout: 3000,\n        });\n        query.value = '';\n        hideLoader();\n        hideLoadMoreButton();\n        return;\n    }\n\n    await getImagesByQuery(trimmedQuery, page, limit)\n        .then(result => {\n            \n            if (result.hits.length === 0) {\n                throw new Error('No result');\n            }\n            createGallery(result.hits);\n\n            totalPages = Math.ceil(result.totalHits / limit);\n            if (page < totalPages) {\n                showLoadMoreButton();\n            }\n        })\n        .catch(error => {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                position: 'topRight',\n                timeout: 3000,\n            });\n            hideLoadMoreButton();\n        })\n        .finally(() => {\n            query.value = '';\n    })\n    \n}\n\n\nasync function handleLoadMore() {\n    page++;\n    loadMoreBtn.disabled = true;\n    showLoader();\n\n\n    try { \n        const data = await getImagesByQuery(searchQuery, page, limit);\n        createGallery(data.hits);\n        \n        setTimeout(() => {\n            const firstCard = document.querySelector('.gallery-item');\n            if (firstCard) {\n                const cardHeight = firstCard.getBoundingClientRect().height;\n                window.scrollBy({\n                    top: cardHeight * 2,\n                    behavior: 'smooth'\n                });\n            }\n        }, 100);    \n\n        if (page >= totalPages) {\n            hideLoadMoreButton();\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n                timeout: 3000,\n            });\n\n        }\n\n    } catch {\n         iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                position: 'topRight',\n                timeout: 3000,\n            });\n\n    } finally {\n        loadMoreBtn.disabled = false;\n        hideLoader();\n\n    }\n}"],"names":["API_KEY","getImagesByQuery","query","page","limit","data","axios","loadMoreBtn","gallery","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","totalPages","searchQuery","handleSubmit","handleLoadMore","event","trimmedQuery","iziToast","result","error","firstCard","cardHeight"],"mappings":"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"}